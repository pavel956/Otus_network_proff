
# **BGP. Фильтрация**
________________________________________________________
- Настроить фильтрацию в офисе Москва так, чтобы не появилось транзитного трафика(As-path).
- Настроить фильтрацию в офисе С.-Петербург так, чтобы не появилось транзитного трафика(Prefix-list).
- Настроить провайдера Киторн так, чтобы в офис Москва отдавался только маршрут по умолчанию.
- Настроить провайдера Ламас так, чтобы в офис Москва отдавался только маршрут по умолчанию и префикс офиса С.-Петербург.
Все сети в лабораторной работе должны иметь IP связность.
План работы и изменения зафиксированы в документации.



1. 
 Списки доступа AS_PATH читаются как обычные списки доступа (access-lists). Операторы читаются последовательно, и в конце есть неявный запрет. Вместо сопоставления адреса в каждом операторе, как в обычном списке доступа, списки доступа по атрибуту AS_PATH сопоставляются по так называемому регулярному выражению (regular expression). Регулярные выражения — это шаблоны, используемые для сопоставления последовательностей символов в строках. Укажем специальный тип access-list для сопоставления маршрутов BGP с атрибутом AS_PATH

<pre><code>ip as-path access-list 300 permit ^$</code></pre>
Регулярное выражение ^$ гарантирует, что будут рассылаться только локально созданные маршруты.
 

Применим настроенный access-list с помощью команды neighbor с параметром filter-list. Ключевое слово out указывает, что список применяется к информации маршрутизации, отправляемой этому соседу:

<pre><code> neighbor 172.16.5.2 filter-list 300 out</code></pre>

чтобы убедиться, что фильтр работает должным образом. Выполним команду show ip bgp regexp ^$:


<img src="R14_1.png" alt="image" width="60%" height="auto">

[регулярные выражения](regular/)

2.
Используем префикс лист, где разрешим только сети VPC VPC8, Применим настроенный префикс лист на соседей.

<pre><code>ip prefix-list NO_TRANSIT seq 5 permit 192.168.80.0/24
ip prefix-list NO_TRANSIT seq 10 permit 192.168.0.0/24

neighbor 172.16.5.25 prefix-list NO_TRANSIT out</code></pre>

проверяем до фильтрации анонсируем

<img src="R18_adv.png" alt="image" width="60%" height="auto">

после применения фильтра на соседа

<img src="R18_adv2.png" alt="image" width="60%" height="auto">

3.


 [конфигурация узлов](conf/)

 [ip_route](ip_route/)